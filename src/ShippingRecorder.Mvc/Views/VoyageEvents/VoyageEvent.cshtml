@model ShippingRecorder.Mvc.Models.VoyageEventViewModel

@Html.AntiForgeryToken()
@Html.HiddenFor(m => m.Id)
@Html.HiddenFor(m => m.VoyageId)

<div class="row">
    <div class="col-3">
        <strong>@Html.LabelFor(m => m.VoyageNumber)</strong>
        <div class="input-group">
            @Html.TextBoxFor(m => m.VoyageNumber, new { @class = "form-control", @disabled = "" })
        </div>
        <span>@Html.ValidationMessageFor(m => m.VoyageNumber, "", new { @class = "text-danger" })</span>
    </div>
</div>
<br />

<div class="row">
    <div class="col-3">
        <strong>@Html.LabelFor(m => m.Date)</strong>
        <div class="input-group">
            @Html.EditorFor(m => m.Date, new { @class = "form-control" })
        </div>
        <span>@Html.ValidationMessageFor(m => m.Date, "", new { @class = "text-danger" })</span>
    </div>
</div>
<br />

<div class="row">
    <div class="col-3">
        <strong>@Html.LabelFor(m => m.Port)</strong>
        <div class="input-group">
            @Html.TextBoxFor(m => m.Port, new {
                @class = "form-control",
                type = "text",
                inputmode = "text",
                pattern = "[A-Z]{2}[A-Z0-9]{3}",
                oninput = "let v=this.value.toUpperCase().replace(/[^A-Z0-9]/g,'');let r='';for(let i=0;i<v.length && r.length<5;i++){let c=v.charAt(i);if(r.length<2){if(/[A-Z]/.test(c))r+=c;}else{r+=c;}}this.value=r;"
            })
        </div>
        <span>@Html.ValidationMessageFor(m => m.Port, "", new { @class = "text-danger" })</span>
    </div>
</div>
<br />

<div class="row">
    <div class="col-3">
        <strong>@Html.LabelFor(m => m.EventType)</strong>
        <div class="input-group">
            @Html.DropDownListFor(m => m.EventType, Model.EventTypes, new {
                @class = "form-control",
                onchange = "onEventTypeChanged()"
            })
        </div>
        <span>@Html.ValidationMessageFor(m => m.EventType, "", new { @class = "text-danger" })</span>
    </div>
</div>
<br />

@if (Model.Id <= 0)
{
    <div name="SamedDayDeparture" id="SamedDayDeparture" class="row">
        <div class="col">
            <div class="form-check">
                @Html.CheckBoxFor(m => m.AddSameDayDeparture, new { @class = "form-check-input" })
                @Html.LabelFor(m => m.AddSameDayDeparture, new { @class = "form-check-label" })
            </div>

            <span>
                @Html.ValidationMessageFor(m => m.AddSameDayDeparture, "", 
                    new { @class = "text-danger" })
            </span>
        </div>
    </div>
    <br/>
}

<div class="row">
    <div class="col-md">
        <div class="input-group">
            <a class="btn btn-primary" role="button" asp-area="" asp-controller="VoyageBuilder" asp-action="Index" asp-route-id="@Model.VoyageId" style="margin-right: 10px">Cancel</a>
            <button type="submit" class="btn btn-primary">Save</button>
        </div>
    </div>
</div>

<script type="text/javascript">
    function onEventTypeChanged() {
        var id = parseInt($("#Id").val());
        var eventType = $("#EventType").val();
        if ((id <= 0) && (eventType == "Arrive")) {
            $("#SamedDayDeparture").show();
        } else {
            $("#SamedDayDeparture").hide();
            $("#SamedDayDeparture").prop("checked", false);
        }
    }
</script>